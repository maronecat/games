<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <!-- ã‚¹ãƒãƒ›ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã®ç”»é¢å¹…ã«å¯¾å¿œã•ã›ã‚‹ãŸã‚ã®è¨˜è¿° -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚·ãƒ¥ãƒ¬ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼ãƒ»ã‚­ãƒ£ãƒƒãƒ„</title>
  <style>
    /* --- ãµã‚“ã‚ã‚Šãƒ‘ã‚¹ãƒ†ãƒ«èª¿ã®èƒŒæ™¯ï¼†è»½ã„è£…é£¾ --- */
    body {
      margin: 0;
      padding: 20px;
      font-family: "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
      background: linear-gradient(120deg, #ffe2e2 0%, #7ad5ff 100%);
      text-align: center;
    }
    h1 {
      color: #635155;
      text-shadow: 1px 1px 2px #fff;
      margin: 10px 0;
    }

    /* --- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºã‚¨ãƒªã‚¢ --- */
    #status {
      margin: 10px auto;
      font-size: 18px;
      max-width: 600px;
      padding: 10px;
      background-color: #fff6f9;
      border-radius: 8px;
      box-shadow: 1px 1px 6px rgba(0,0,0,0.1);
    }
    #status span {
      color: #c64561;
      font-weight: bold;
    }

    /* --- ãƒ’ãƒ³ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ --- */
    #hints {
      margin: 10px auto;
      max-width: 600px;
      font-size: 16px;
      background-color: #fff;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 1px 1px 6px rgba(0,0,0,0.1);
    }
    #rowHints, #colHints {
      margin: 5px 0;
      color: #635155;
    }

    /* 
      --- ãƒ‘ã‚ºãƒ«ã¨çŒ«ã‚’ä¸¦ã¹ã‚‹ã‚³ãƒ³ãƒ†ãƒŠ ---
      display: flex; gap: 20px; ã§æ¨ªä¸¦ã³ã€‚
      ç”»é¢å¹…ãŒç‹­ã„æ™‚ã¯ç¸¦é…ç½®ã«ãªã‚‹ã‚ˆã†ã«flex-wrapã§èª¿æ•´
    */
    #puzzleContainer {
      display: flex;
      flex-wrap: wrap;
      align-items: flex-start;
      justify-content: center;
      margin: 20px auto;
      gap: 20px;
      max-width: 900px; /* ä½™è£•ã‚’ã‚‚ãŸã›ã‚‹ */
    }

    /* --- ã‚²ãƒ¼ãƒ ç›¤ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ --- */
    table {
      border-collapse: collapse;
      box-shadow: 2px 2px 10px rgba(0,0,0,0.15);
      margin: 0 auto; /* ã‚¹ãƒãƒ›ã§ç¸¦é…ç½®ã•ã‚ŒãŸéš›ã‚‚ä¸­å¤®æƒãˆ */
    }
    td {
      width: 50px;
      height: 50px;
      border: 2px solid #f9bccd;
      background-color: #fff;
      font-size: 26px;
      text-align: center;
      vertical-align: middle;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.2s;
    }
    td:hover {
      background-color: #ffebf2;
    }

    /* --- ãƒªã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ --- */
    #restartBtn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
      border: none;
      border-radius: 8px;
      background-color: #f4a4bb;
      color: #fff;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
      transition: background-color 0.3s;
      display: none;
    }
    #restartBtn:hover {
      background-color: #e07e96;
    }

    /* --- çŒ«ç”»åƒã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« (ã‚µã‚¤ã‚ºã¯ãŠå¥½ã¿ã§èª¿æ•´) --- */
    #cuteCat {
      width: 120px;        /* çŒ«ã®ç”»åƒã‚µã‚¤ã‚º */
      margin-top: 10px;
      cursor: pointer;     /* ã‚¯ãƒªãƒƒã‚¯ã§ãã‚‹æ„Ÿã˜ã‚’å‡ºã™ */
    }

    /* --- ã‚†ã‚‰ã‚†ã‚‰ãƒ€ãƒ³ã‚¹ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³(keyframes) --- */
    @keyframes catDance {
      0%   { transform: rotate(0deg)   scale(1);   }
      25%  { transform: rotate(-5deg)  scale(1.2); }
      50%  { transform: rotate(5deg)   scale(0.8); }
      75%  { transform: rotate(-5deg)  scale(1.1); }
      100% { transform: rotate(0deg)   scale(1);   }
    }

    /* --- ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ãƒãƒ¨ãƒ³ã¨å¼¾ã‚€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³(keyframes) --- */
    @keyframes catPoyon {
      0%   { transform: scale(1); }
      50%  { transform: scale(1.5); }
      100% { transform: scale(1); }
    }

    /* --- ã‚†ã‚‰ã‚†ã‚‰ãƒ€ãƒ³ã‚¹ã‚’ç„¡é™ã«ç¶šã‘ã‚‹ã‚¯ãƒ©ã‚¹ --- */
    .catDance {
      animation: catDance 2s ease-in-out infinite;
      display: block;
    }

    /* --- ã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¦ãƒãƒ¨ãƒ³ã™ã‚‹ã‚¯ãƒ©ã‚¹(ä¸€æ™‚çš„) --- */
    .poyon {
      animation: catPoyon 0.3s ease-in-out forwards;
    }

    /* --- èª¬æ˜æ–‡ã¯ä¸‹éƒ¨ã«é…ç½® --- */
    #explanation {
      margin: 30px auto 0 auto;
      max-width: 600px;
      background-color: rgba(255,255,255,0.8);
      border-radius: 8px;
      padding: 15px;
      font-size: 14px;
      color: #444;
      line-height: 1.6;
      box-shadow: 1px 1px 6px rgba(0,0,0,0.1);
      text-align: left;
    }
    #explanation h2 {
      margin-top: 0;
    }

    /* --- ã‚¹ãƒãƒ›å‘ã‘ã«ã‚µã‚¤ã‚ºã‚’èª¿æ•´(600pxä»¥ä¸‹) --- */
    @media (max-width: 600px) {
      body {
        padding: 10px;
      }
      h1 {
        font-size: 22px;
      }
      #status, #hints {
        font-size: 14px;
        width: 90%;
      }
      table td {
        width: 40px;
        height: 40px;
        font-size: 20px;
      }
      #restartBtn {
        font-size: 16px;
      }
      #explanation {
        font-size: 12px;
        width: 90%;
      }
      #cuteCat {
        width: 100px; /* ã‚¹ãƒãƒ›è¡¨ç¤ºæ™‚ã«ã‚„ã‚„å°ã•ã */
        margin: 0 auto;
        display: block;
        /* ã‚¹ãƒãƒ›æ™‚ã«ã¯ã€çŒ«ã‚¢ã‚¤ã‚³ãƒ³ãŒä¸Šã«å›ã‚Šè¾¼ã‚“ã§ã—ã¾ã†ã®ã§
           orderã‚’å¤‰æ›´ã—ã¦å…ˆé ­ã«æŒã£ã¦ãã‚‹ãªã©å¥½ã¿ã§èª¿æ•´OK */
        order: -1;
      }
    }
  </style>
</head>
<body>
  <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
  <h1>ã‚·ãƒ¥ãƒ¬ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼â¤ï¸ã‚­ãƒ£ãƒƒãƒ„</h1>

  <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º -->
  <div id="status">
    ã‚¹ã‚³ã‚¢: <span id="score">0</span> /
    ãƒ©ã‚¤ãƒ•: <span id="lives">3</span>
  </div>

  <!-- ãƒ’ãƒ³ãƒˆè¡¨ç¤º -->
  <div id="hints">
    <p id="rowHints"></p>
    <p id="colHints"></p>
  </div>

  <!-- ãƒ‘ã‚ºãƒ«ã¨çŒ«ã‚’æ¨ªä¸¦ã³è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠ -->
  <div id="puzzleContainer">
    <!-- çŒ«ç”»åƒï¼šåˆæœŸçŠ¶æ…‹ã§ã€ŒcatDanceã€ã‚¯ãƒ©ã‚¹ã‚’ä»˜ã‘ã¦æºã‚Œã‚¢ãƒ‹ãƒ¡é–‹å§‹ -->
    <img src="cat.PNG" id="cuteCat" alt="Cute Cat" class="catDance">
  </div>
    <!-- ã‚²ãƒ¼ãƒ ç›¤ -->
    <table id="gameTable"></table>


  <!-- ãƒªã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ -->
  <button id="restartBtn">ã‚‚ã†ã„ã£ã‹ã„ã‚„ã‚‹ã«ã‚ƒ</button>

  <!-- ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
  <script>
    const table = document.getElementById("gameTable");
    const scoreSpan = document.getElementById("score");
    const livesSpan = document.getElementById("lives");
    const rowHintsP = document.getElementById("rowHints");
    const colHintsP = document.getElementById("colHints");
    const restartBtn = document.getElementById("restartBtn");
    const catIcon = document.getElementById("cuteCat");

    let boxes = [];       // ã‚²ãƒ¼ãƒ ç›¤ã®çŠ¶æ…‹ã‚’æ ¼ç´ã™ã‚‹2æ¬¡å…ƒé…åˆ—
    let revealed = [];    // å„ãƒã‚¹ãŒé–‹ã„ã¦ã„ã‚‹ã‹ã©ã†ã‹
    let rowHints = [];    // å„è¡Œã«ã„ã‚‹å…ƒæ°—ãªã«ã‚ƒã‚“ã“ã®æ•°
    let colHints = [];    // å„åˆ—ã«ã„ã‚‹å…ƒæ°—ãªã«ã‚ƒã‚“ã“ã®æ•°
    let totalLiveCats = 0; // å…¨ãƒã‚¹ä¸­ã®å…ƒæ°—ãªã«ã‚ƒã‚“ã“ã®æ•°
    let foundLiveCats = 0; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¦‹ã¤ã‘ãŸå…ƒæ°—ãªã«ã‚ƒã‚“ã“ã®æ•°
    let score = 0;
    let lives = 3;
    let gameOver = false;

    // --- çŒ«ç”»åƒã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã«ãƒãƒ¨ãƒ³ã¨å¼¾ã‚€ ---
    catIcon.addEventListener("click", () => {
      // 1. ã‚†ã‚‰ã‚†ã‚‰ãƒ€ãƒ³ã‚¹ã‚’ä¸€æ™‚çš„ã«å¤–ã—ã¦â€¦
      catIcon.classList.remove("catDance");
      // 2. ãƒãƒ¨ãƒ³ã‚¢ãƒ‹ãƒ¡ã‚’ä»˜ã‘ã‚‹
      catIcon.classList.add("poyon");

      // 0.3ç§’å¾Œã«ãƒãƒ¨ãƒ³ã‚¢ãƒ‹ãƒ¡ã‚’å¤–ã—ã¦ã€å†ã³ãƒ€ãƒ³ã‚¹ã‚’å¾©å¸°
      setTimeout(() => {
        catIcon.classList.remove("poyon");
        catIcon.classList.add("catDance");
      }, 300);
    });

    // ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
    function initGame() {
      gameOver = false;
      score = 0;
      lives = 3;
      foundLiveCats = 0;
      scoreSpan.textContent = score;
      livesSpan.textContent = lives;
      restartBtn.style.display = "none";

      boxes = [];
      revealed = [];
      totalLiveCats = 0;

      // 4x4ã®ãƒã‚¹ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é…ç½®
      // ä¾‹ï¼šlive(å…ƒæ°—):25%, sleep(ãŠã‚„ã™ã¿):25%, none(ä½•ã‚‚ãªã—):50%
      for (let row = 0; row < 4; row++) {
        let rowArr = [];
        let revealArr = [];
        for (let col = 0; col < 4; col++) {
          let rand = Math.random();
          let state;
          if (rand < 0.25) {
            state = "live";
            totalLiveCats++;
          } else if (rand < 0.5) {
            state = "sleep"; // ãŠã‚„ã™ã¿ãªã«ã‚ƒã‚“ã“
          } else {
            state = "none";  // ä½•ã‚‚ãªã„
          }
          rowArr.push(state);
          revealArr.push(false);
        }
        boxes.push(rowArr);
        revealed.push(revealArr);
      }

      // è¡Œãƒ»åˆ—ã”ã¨ã®ã€Œå…ƒæ°—ãªã«ã‚ƒã‚“ã“ã€ã®æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
      rowHints = [0,0,0,0];
      colHints = [0,0,0,0];

      for (let row = 0; row < 4; row++) {
        for (let col = 0; col < 4; col++) {
          if (boxes[row][col] === "live") {
            rowHints[row]++;
            colHints[col]++;
          }
        }
      }

      drawTable();
      rowHintsP.textContent = `è¡Œãƒ’ãƒ³ãƒˆ: [${rowHints.join(" / ")}]`;
      colHintsP.textContent = `åˆ—ãƒ’ãƒ³ãƒˆ: [${colHints.join(" / ")}]`;
    }

    // ãƒ†ãƒ¼ãƒ–ãƒ«æç”»
    function drawTable() {
      table.innerHTML = "";
      for (let row = 0; row < 4; row++) {
        const tr = document.createElement("tr");
        for (let col = 0; col < 4; col++) {
          const td = document.createElement("td");
          td.textContent = revealed[row][col] ? getSymbol(boxes[row][col]) : "â“";
          td.style.cursor = revealed[row][col] || gameOver ? "default" : "pointer";

          // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
          td.addEventListener("click", () => {
            if (!gameOver && !revealed[row][col]) {
              revealBox(row, col);
            }
          });
          tr.appendChild(td);
        }
        table.appendChild(tr);
      }
    }

    // ãƒã‚¹ã®çŠ¶æ…‹ã«å¿œã˜ãŸçµµæ–‡å­—ã‚’è¿”ã™
    function getSymbol(state) {
      switch(state) {
        case "live":  return "ğŸ±"; // å…ƒæ°—ãªã«ã‚ƒã‚“ã“
        case "sleep": return "ğŸ’¤"; // ãŠã‚„ã™ã¿ãªã«ã‚ƒã‚“ã“
        default:      return "âŒ"; // ä½•ã‚‚ãªã„
      }
    }

    // æŒ‡å®šãƒã‚¹ã‚’é–‹ãå‡¦ç†
    function revealBox(row, col) {
      revealed[row][col] = true;
      const state = boxes[row][col];

      if (state === "live") {
        score++;
        foundLiveCats++;
      } else if (state === "sleep") {
        lives--;
      }

      // ã‚¹ã‚³ã‚¢ã‚„ãƒ©ã‚¤ãƒ•ã‚’æ›´æ–°
      scoreSpan.textContent = score;
      livesSpan.textContent = lives;

      // å‹æ•—åˆ¤å®š
      if (foundLiveCats === totalLiveCats) {
        endGame(true);
      } else if (lives <= 0) {
        endGame(false);
      }

      drawTable();
    }

    // ã‚²ãƒ¼ãƒ çµ‚äº†å‡¦ç†
    function endGame(isWin) {
      gameOver = true;
      drawTable();
      restartBtn.style.display = "inline-block";
      if (isWin) {
        alert(`å…ƒæ°—ãªã«ã‚ƒã‚“ã“ã‚’å…¨éƒ¨è¦‹ã¤ã‘ãŸã«ã‚ƒï¼\nã‚¹ã‚³ã‚¢: ${score}`);
      } else {
        alert(`ãƒ©ã‚¤ãƒ•ãŒãªããªã£ã¡ã‚ƒã£ãŸã«ã‚ƒâ€¦\næœ€çµ‚ã‚¹ã‚³ã‚¢: ${score}`);
      }
    }

    // ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ
    restartBtn.addEventListener("click", initGame);

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
    initGame();
  </script>

  <!-- ã‚²ãƒ¼ãƒ ã®èª¬æ˜ï¼ˆä¸‹ã«é…ç½®ï¼‰ -->
  <div id="explanation">
    <h2>ã€ã‚²ãƒ¼ãƒ èª¬æ˜ã€‘</h2>
    <p>
      ã“ã“ã¯ä¸æ€è­°ãªã€Œã‚·ãƒ¥ãƒ¬ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼ã®çŒ«ã€ã®ä¸–ç•Œã«ã‚ƒã€‚<br>
      4Ã—4ãƒã‚¹ã®ã©ã“ã‹ã«ã€Œå…ƒæ°—ãªã«ã‚ƒã‚“ã“ã€ã¨ã€ŒãŠã‚„ã™ã¿ãªã«ã‚ƒã‚“ã“ã€ãŒéš ã‚Œã¦ã‚‹ã‚ˆã€‚
    </p>
    <ul>
      <li>å…ƒæ°—ãªã«ã‚ƒã‚“ã“ã‚’é–‹ã â†’ <b>ã‚¹ã‚³ã‚¢+1</b></li>
      <li>ãŠã‚„ã™ã¿ãªã«ã‚ƒã‚“ã“ã‚’é–‹ã â†’ <b>ãƒ©ã‚¤ãƒ•-1</b></li>
      <li>ä½•ã‚‚ãªã„ãƒã‚¹ã¯ã‚»ãƒ¼ãƒ•</li>
    </ul>
    <p>
      å„è¡Œãƒ»åˆ—ã®ãƒ’ãƒ³ãƒˆï¼ˆå…ƒæ°—ãªã«ã‚ƒã‚“ã“ã®æ•°ï¼‰ã‚’æ‰‹ãŒã‹ã‚Šã«ã€<br>
      ãƒã‚¹ã‚’ã†ã¾ãã€Œè¦³æ¸¬ã€ã—ã¦ã«ã‚ƒã‚“ã€‚<br>
      ãƒ©ã‚¤ãƒ•ãŒ0ã«ãªã‚‹å‰ã«å…¨éƒ¨ã®å…ƒæ°—ãªã«ã‚ƒã‚“ã“ã‚’è¦‹ã¤ã‘ã‚‰ã‚ŒãŸã‚‰ã‚¯ãƒªã‚¢ã ã‚ˆã€œï¼
    </p>
  </div>
</body>
</html>
