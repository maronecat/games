<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Cat Tower Jump - Multi Stages</title>

  <!-- ã‚¹ãƒãƒ›ã§ã®ãƒ”ãƒ³ãƒã‚ºãƒ¼ãƒ ã‚’ç„¡åŠ¹åŒ– + ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—ã«ã‚ˆã‚‹æ‹¡å¤§ã‚’æŠ‘æ­¢ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

  <style>
    /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚„é•·æŠ¼ã—ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ç„¡åŠ¹åŒ– + ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—æŠ‘æ­¢ã«touch-action */
    html, body {
      margin: 0;
      padding: 0;
      background: #f0f8ff;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      touch-action: none; /* ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—ã‚ºãƒ¼ãƒ æŠ‘æ­¢ (iOSã§æœ‰åŠ¹ãªå ´åˆãŒå¤šã„) */
      overflow: hidden;   /* ã‚²ãƒ¼ãƒ ç”»é¢ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä¸è¦ãªã‚‰ overflowã‚’éš ã™ */
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      font-family: sans-serif;
    }

    #gameCanvas {
      width: 360px;
      height: 640px;
      border: 2px solid #333;
      margin-top: 10px;
      display: block;
      background: #ffffff;
    }

    #mobileControls {
      margin-top: 10px;
      display: flex;
      flex-direction: row;
      gap: 10px;
    }

    #mobileControls button {
      font-size: 1.2rem;
      padding: 15px 25px;
      border-radius: 8px;
      border: 1px solid #aaa;
      background: #fff;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
    }

    #info {
      margin-top: 5px;
      font-size: 14px;
      color: #333;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="360" height="640"></canvas>

  <!-- ã‚¹ãƒãƒ›ç”¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ© -->
  <div id="mobileControls">
    <button id="leftBtn">â†</button>
    <button id="rightBtn">â†’</button>
    <button id="jumpBtn">Jump</button>
  </div>

  <div id="info">
    PCæ“ä½œ: ã‚¹ãƒšãƒ¼ã‚¹=ã‚¸ãƒ£ãƒ³ãƒ— / L=å³ / K=å·¦
  </div>

  <!-- BGM (ãƒ«ãƒ¼ãƒ—) + çŒ«ã®é³´ãå£° -->
  <audio id="bgmAudio" src="bgm01.wav" preload="auto" loop></audio>
  <audio id="meowSound" src="meow.wav" preload="auto"></audio>

  <script>
    // ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ã®æ‹¡å¤§ã‚’æŠ‘æ­¢ï¼ˆPCãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚ç„¡åŠ¹åŒ–ï¼‰
    document.addEventListener('dblclick', (e) => {
      e.preventDefault();
    }, { passive: false });

    // ------------------------------------------
    // ã‚²ãƒ¼ãƒ è¨­å®šãƒ»å¤‰æ•°
    // ------------------------------------------
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const CANVAS_WIDTH = canvas.width;   
    const CANVAS_HEIGHT = canvas.height; 

    // çŒ«ã‚­ãƒ£ãƒ©
    let cat = {
      x: 160,
      y: 500,
      width: 40,
      height: 40,
      vx: 0,
      vy: 0,
      onGround: false,
      facingRight: false
    };

    // å…¥åŠ›
    let keys = { left: false, right: false, jump: false };

    // ç‰©ç†
    const GRAVITY = 0.4;
    const JUMP_POWER = -12;
    const MOVE_SPEED = 3;

    // è·é›¢
    let distance = 0;
    let isGameRunning = true;
    let lives = 3;

    // ------ ã‚¨ãƒªã‚¢è¨­å®š ------
    // 0ï½1000    åœ°ä¸Š (#f3f4f4)         éšœå®³ç‰©ãªã—
    // 1000ï½2000 ç©º (#cceeff)           éšœå®³ç‰©: ğŸ•Šï¸(é³¥)
    // 2000ï½3000 ã‚ªã‚¾ãƒ³å±¤ (#88bbff)     éšœå®³ç‰©: â˜ï¸(é›²)
    // 3000ï½4000 å®‡å®™ (#303060)         éšœå®³ç‰©: âœ¨(æ˜Ÿ)
    // 4000ï½5000 è™¹è‰²(gradient)         éšœå®³ç‰©: ğŸ‘¼(å¤©ä½¿, ãã­ãã­ç§»å‹•)
    // 5000 ã§ã‚´ãƒ¼ãƒ«
    const GROUND_END  = 3000;
    const SKY_END     = 6000;
    const OZONE_END   = 9000;
    const SPACE_END   = 12000;
    const RAINBOW_END = 15000;
    const GOAL_DIST   = 18000;

    // BGM
    const bgmAudio = document.getElementById("bgmAudio");
    let bgmStarted = false;

    // çŒ«ã®é³´ãå£°
    const meowSound = document.getElementById("meowSound");

    // ------------------------------------------
    // ã‚­ãƒ£ãƒƒãƒˆã‚¿ãƒ¯ãƒ¼é–¢ä¿‚
    // ------------------------------------------
    const towerColors = [
      "#ff7f7f", "#ff7fbf", "#ff7fff", "#bf7fff",
      "#7fbfff", "#7fffff", "#7fffbf", "#7fff7f",
      "#bfff7f", "#ffff7f", "#ffbf7f", "#7f7fff"
    ];
    let platforms = [];
    const TOWER_COLUMN_WIDTH = 15;
    const TOWER_COLUMN_HEIGHT = 50;

    // æœ€çµ‚è¸ã¿å°ã‚’ç‰¹åˆ¥ãƒ‡ã‚¶ã‚¤ãƒ³ã«ã—ãŸã„ â†’ distance ãŒ GOAL_DIST è¿‘ã„å ´åˆã«è‰²ã‚’å¤‰ãˆã‚‹ãªã©
    // å¾Œã§ drawPlatforms() ã§å®Ÿè£…

    function initPlatforms() {
      // åœ°é¢ç”¨
      platforms.push({
        x: 0, y: 600,
        width: CANVAS_WIDTH, height: 20,
        color: "#ff7f7f"
      });
      // åˆæœŸè¶³å ´
      let currentY = 450;
      for (let i = 0; i < 5; i++) {
        addPlatform(currentY);
        currentY -= 100;
      }
    }

    function addPlatform(y) {
      const w = 80, h = 10;
      const x = Math.random() * (CANVAS_WIDTH - w);
      const color = towerColors[Math.floor(Math.random() * towerColors.length)];
      platforms.push({ x, y, width: w, height: h, color });
    }

    function addNewPlatformsIfNeeded() {
      let topY = Infinity;
      for (let p of platforms) {
        if (p.y < topY) topY = p.y;
      }
      while (topY > 0) {
        topY -= 100;
        addPlatform(topY);
      }
    }

    // ------------------------------------------
    // éšœå®³ç‰©
    // ------------------------------------------
    let obstacles = [];
    let frameCount = 0;

    // å„éšœå®³ç‰©ã®ç”Ÿæˆ
    function spawnBird() {
      // ğŸ•Šï¸
      const symbol = "ğŸ•Šï¸";
      const w = 30, h = 30;
      const fromLeft = (Math.random() < 0.5);
      let x, vx;
      if (fromLeft) {
        x = -w; vx = 1 + Math.random() * 1; // 1~2
      } else {
        x = CANVAS_WIDTH + w; vx = -1 - Math.random() * 1; // -2~-1
      }
      const y = Math.random() * (CANVAS_HEIGHT / 2);
      obstacles.push({ x, y, vx, width: w, height: h, symbol, type:"bird" });
    }

    function spawnCloud() {
      // â˜ï¸
      const symbol = "â˜ï¸";
      const w = 30, h = 30;
      const fromLeft = (Math.random() < 0.5);
      let x, vx;
      if (fromLeft) {
        x = -w; vx = 1 + Math.random() * 1;
      } else {
        x = CANVAS_WIDTH + w; vx = -1 - Math.random() * 1;
      }
      const y = Math.random() * (CANVAS_HEIGHT / 2);
      obstacles.push({ x, y, vx, width: w, height: h, symbol, type:"cloud" });
    }

    function spawnStar() {
      // âœ¨
      const symbol = "âœ¨";
      const w = 20, h = 20;
      const fromLeft = (Math.random() < 0.5);
      let x, vx;
      if (fromLeft) {
        x = -w; vx = 2 + Math.random() * 2;
      } else {
        x = CANVAS_WIDTH + w; vx = -2 - Math.random() * 2;
      }
      const y = Math.random() * (CANVAS_HEIGHT / 2);
      obstacles.push({ x, y, vx, width: w, height: h, symbol, type:"star" });
    }

    function spawnAngel() {
      // ğŸ‘¼ (ãã­ãã­ç§»å‹•ã‚’ã•ã›ã‚‹)
      const symbol = "ğŸ‘¼";
      const w = 30, h = 30;
      const fromLeft = (Math.random() < 0.5);
      let x, vx;
      if (fromLeft) {
        x = -w; vx = 3 + Math.random() * 2;
      } else {
        x = CANVAS_WIDTH + w; vx = -3 - Math.random() * 2;
      }
      const y = Math.random() * (CANVAS_HEIGHT / 2);
      // è¿½åŠ ã§ä¸Šä¸‹æºã‚Œãªã©ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
      const wiggleAmp = 1 + Math.random() * 2;  // æºã‚Œå¹…
      const wiggleFreq = 0.01 + Math.random() * 0.02; // å‘¨æ³¢æ•°
      obstacles.push({
        x, y, vx, width:w, height:h, symbol,
        type:"angel",
        wiggleAmp, wiggleFreq,
        baseY: y // åŸºæº–
      });
    }

    function getCurrentArea(dist) {
      if (dist < GROUND_END)    return "ground";
      if (dist < SKY_END)       return "sky";
      if (dist < OZONE_END)     return "ozone";
      if (dist < SPACE_END)     return "space";
      if (dist < RAINBOW_END)   return "rainbow";
      return "goal";
    }

    // éšœå®³ç‰©ã®æ›´æ–°
    function updateObstacles() {
      const area = getCurrentArea(distance);

      // ä¸Šã«è¡Œãã»ã©éšœå®³ç‰©ãŒå¢—ãˆã‚‹ï¼†é€Ÿã„ â†’ area ã«å¿œã˜ã¦ãƒ•ãƒ¬ãƒ¼ãƒ å‘¨æœŸã‚„é€Ÿåº¦ã‚¢ãƒƒãƒ—
      frameCount++;
      let freq = 120; // å‡ºç¾é–“éš”ã®åŸºæœ¬
      let speedBonus = 0; // è¿½åŠ é€Ÿåº¦ã®ã—ã‚„ã™ã•

      if (area === "sky") {
        // ğŸ•Šï¸é³¥ã‚’å‡ºã™
        // ex) freq=100ãã‚‰ã„ã«ã—ã¦é³¥ç”Ÿæˆ
        freq = 100;
        if (frameCount % freq === 0) spawnBird();
      }
      else if (area === "ozone") {
        // â˜ï¸é›²
        freq = 90;
        if (distance > 2500) freq = 70; // é€²ã‚€ã»ã©é »åº¦å¢—
        if (frameCount % freq === 0) spawnCloud();
      }
      else if (area === "space") {
        // âœ¨æ˜Ÿ
        freq = 80;
        if (distance > 3500) freq = 60;
        if (frameCount % freq === 0) spawnStar();
      }
      else if (area === "rainbow") {
        // ğŸ‘¼å¤©ä½¿(ãã­ãã­)
        freq = 70;
        if (distance > 4500) freq = 50; // çµ‚ç›¤ã»ã©æ›´ã«å¤šã
        if (frameCount % freq === 0) spawnAngel();
      }

      // ç§»å‹•ï¼†è¡çª
      for (let i = 0; i < obstacles.length; i++) {
        let o = obstacles[i];

        // è™¹è‰²ã‚¨ãƒªã‚¢ã®å¤©ä½¿ã ã‘ä¸Šä¸‹ã«ãã­ãã­ã•ã›ã‚‹ä¾‹
        if (o.type === "angel") {
          // sinæ³¢ã§ä¸Šä¸‹ã«ã‚†ã‚‰ã™
          const wave = Math.sin(frameCount * o.wiggleFreq) * o.wiggleAmp;
          o.y = o.baseY + wave * 10; // 10å€ã—ã¦æŒ¯å¹…èª¿æ•´
        }

        // é€Ÿåº¦
        // ã‚¨ãƒªã‚¢ãŒä¸ŠãŒã‚‹ã»ã©é€Ÿã„ï¼Ÿ â†’ è¿½åŠ ã§ + (distance / 2000) ã¨ã‹
        let areaFactor = 1 + (distance / 3000); 
        o.x += o.vx * areaFactor;

        // ç”»é¢å¤–ã«å‡ºãŸã‚‰æ¶ˆå»
        if (o.x < -100 || o.x > CANVAS_WIDTH + 100) {
          obstacles.splice(i, 1);
          i--;
          continue;
        }

        // AABBè¡çª
        if (
          cat.x < o.x + o.width &&
          cat.x + cat.width > o.x &&
          cat.y < o.y + o.height &&
          cat.y + cat.height > o.y
        ) {
          // è¡çªæ–¹å‘ã‚’åˆ¤å®š
          const cx = cat.x + cat.width/2;
          const cy = cat.y + cat.height/2;
          const ox = o.x + o.width/2;
          const oy = o.y + o.height/2;
          const dx = cx - ox;
          const dy = cy - oy;

          if (Math.abs(dx) > Math.abs(dy)) {
            // å·¦å³è¡çª
            if (dx > 0) {
              cat.x = o.x + o.width;
              cat.vx = Math.min(cat.vx, 0);
            } else {
              cat.x = o.x - cat.width;
              cat.vx = Math.max(cat.vx, 0);
            }
          } else {
            // ä¸Šä¸‹è¡çª
            if (dy > 0) {
              // ä¸‹
              cat.y = o.y + o.height;
              cat.vy = Math.max(cat.vy, 0);
            } else {
              // ä¸Š
              cat.y = o.y - cat.height;
              cat.vy = Math.min(cat.vy, 0) + 5;
            }
          }
        }
      }
    }

    // ------------------------------------------
    // å…¥åŠ›é–¢é€£(PC)
    // ------------------------------------------
    document.addEventListener("keydown", (e) => {
      // æœ€åˆã®ã‚­ãƒ¼å…¥åŠ›ã§BGMé–‹å§‹
      startBGM();

      if (e.code === "Space")  keys.jump = true;
      if (e.key === "l" || e.key === "L") keys.right = true;
      if (e.key === "k" || e.key === "K") keys.left = true;
    });
    document.addEventListener("keyup", (e) => {
      if (e.code === "Space")  keys.jump = false;
      if (e.key === "l" || e.key === "L") keys.right = false;
      if (e.key === "k" || e.key === "K") keys.left = false;
    });

    // ------------------------------------------
    // å…¥åŠ›é–¢é€£(ã‚¹ãƒãƒ›ãƒœã‚¿ãƒ³)
    // ------------------------------------------
    const leftBtn = document.getElementById("leftBtn");
    const rightBtn = document.getElementById("rightBtn");
    const jumpBtn = document.getElementById("jumpBtn");

    function pressLeft(val)  { keys.left = val; startBGM(); }
    function pressRight(val) { keys.right = val; startBGM(); }
    function pressJump(val)  { keys.jump = val; startBGM(); }

    leftBtn.addEventListener("touchstart",  e => { e.preventDefault(); pressLeft(true); });
    leftBtn.addEventListener("touchend",    e => { e.preventDefault(); pressLeft(false); });
    leftBtn.addEventListener("mousedown",   e => { e.preventDefault(); pressLeft(true); });
    leftBtn.addEventListener("mouseup",     e => { e.preventDefault(); pressLeft(false); });

    rightBtn.addEventListener("touchstart", e => { e.preventDefault(); pressRight(true);});
    rightBtn.addEventListener("touchend",   e => { e.preventDefault(); pressRight(false);});
    rightBtn.addEventListener("mousedown",  e => { e.preventDefault(); pressRight(true);});
    rightBtn.addEventListener("mouseup",    e => { e.preventDefault(); pressRight(false);});

    jumpBtn.addEventListener("touchstart",  e => { e.preventDefault(); pressJump(true); });
    jumpBtn.addEventListener("touchend",    e => { e.preventDefault(); pressJump(false); });
    jumpBtn.addEventListener("mousedown",   e => { e.preventDefault(); pressJump(true); });
    jumpBtn.addEventListener("mouseup",     e => { e.preventDefault(); pressJump(false); });

    // ------------------------------------------
    // BGMå†ç”Ÿ
    // ------------------------------------------
    function startBGM() {
      if (!bgmStarted) {
        bgmStarted = true;
        bgmAudio.currentTime = 0;
        bgmAudio.play().catch(err => console.log(err));
      }
    }

    // ------------------------------------------
    // ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—é–¢é€£
    // ------------------------------------------
    function update() {
      if (!isGameRunning) return;

      // æ¨ªç§»å‹•
      cat.vx = 0;
      if (keys.left)  { cat.vx = -MOVE_SPEED; cat.facingRight = false; }
      if (keys.right) { cat.vx =  MOVE_SPEED; cat.facingRight = true; }

      // ã‚¸ãƒ£ãƒ³ãƒ—
      if (keys.jump && cat.onGround) {
        cat.vy = JUMP_POWER;
        cat.onGround = false;
        // ãƒ©ãƒ³ãƒ€ãƒ ã§ meow
        if (Math.random() < 0.2) {
          meowSound.currentTime = 0;
          meowSound.play().catch(e => console.log(e));
        }
      }

      // é‡åŠ›
      cat.vy += GRAVITY;
      cat.x += cat.vx;
      cat.y += cat.vy;

      // å·¦å³ç«¯
      if (cat.x < 0) cat.x = 0;
      else if (cat.x + cat.width > CANVAS_WIDTH) {
        cat.x = CANVAS_WIDTH - cat.width;
      }

      // è¶³å ´ã¨ã®è¡çª
      cat.onGround = false;
      for (let p of platforms) {
        if (
          cat.x < p.x + p.width &&
          cat.x + cat.width > p.x &&
          cat.y + cat.height > p.y &&
          cat.y + cat.height - cat.vy <= p.y
        ) {
          cat.y = p.y - cat.height;
          cat.vy = 0;
          cat.onGround = true;
        }
      }

      // è½ä¸‹
      if (cat.y > CANVAS_HEIGHT) {
        lives--;
        if (lives <= 0) {
          alert("Game Over...ãƒªãƒˆãƒ©ã‚¤ã—ã¦ã­");
          isGameRunning = false;
        } else {
          // å†é…ç½®
          cat.x = 160; cat.y = 200;
          cat.vy = 0;
          cat.onGround = false;
        }
      }

      // ä¸Šæ˜‡ã«ä¼´ã†ç”»é¢ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
      if (cat.y < 200) {
        const diff = 200 - cat.y;
        cat.y = 200;
        for (let p of platforms) {
          p.y += diff;
        }
        for (let o of obstacles) {
          o.y += diff;
        }
        distance += diff;
        addNewPlatformsIfNeeded();
      }

      // éšœå®³ç‰©
      updateObstacles();

      // ã‚´ãƒ¼ãƒ«
      if (distance >= GOAL_DIST) {
        alert("ã‚´ãƒ¼ãƒ«ï¼ãŠã‚ã§ã¨ã†ï¼ï¼");
        isGameRunning = false;
      }
    }

    function draw() {
      drawBackground();
      drawPlatforms();
      drawObstacles();
      drawCat();
      drawHUD();
    }

    // ------------------------------------------
    // èƒŒæ™¯
    // ------------------------------------------
    function drawBackground() {
      const area = getCurrentArea(distance);

      if (area === "ground") {
        ctx.fillStyle = "#f3f4f4"; 
      } else if (area === "sky") {
        ctx.fillStyle = "#cceeff";
      } else if (area === "ozone") {
        ctx.fillStyle = "#88bbff"; 
      } else if (area === "space") {
        ctx.fillStyle = "#303060";
      } else if (area === "rainbow") {
        let grad = ctx.createLinearGradient(0, 0, CANVAS_WIDTH, 0);
        grad.addColorStop(0,   "#ff8a8a");
        grad.addColorStop(0.2, "#ffe48a");
        grad.addColorStop(0.4, "#d1ff8a");
        grad.addColorStop(0.6, "#8afff6");
        grad.addColorStop(0.8, "#8ad1ff");
        grad.addColorStop(1,   "#d48aff");
        ctx.fillStyle = grad;
      } else {
        ctx.fillStyle = "#eaeaea";
      }

      ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
    }

    // ------------------------------------------
    // è¶³å ´æç”» (æœ€çµ‚è¸ã¿å°ã ã‘ç‰¹åˆ¥ãªè¦‹ãŸç›®ã«)
    // ------------------------------------------
    function drawPlatforms() {
      for (let p of platforms) {
        // ã‚´ãƒ¼ãƒ«ã«è¿‘ã„ã»ã©(è·é›¢ + (200 - p.y)?) -> ã‚‚ã—ãã¯
        // ç°¡å˜ã«ã€Œç”»é¢ä¸Šéƒ¨(0ï½100)ã«ã‚ã‚‹è¶³å ´ã‹ã¤ distance >= GOAL_DIST - 50ã€ãªã©ã§ãƒã‚§ãƒƒã‚¯
        let color = p.color;

        // ä¾‹ãˆã°æœ€çµ‚ã‚¨ãƒªã‚¢ã«å…¥ã‚Šã€ã•ã‚‰ã«è¶³å ´ãŒç”»é¢ã®ä¸Šã®æ–¹ãªã‚‰ã€Œé‡‘è‰²ã€ã«ã™ã‚‹
        if (distance > (GOAL_DIST - 100)) {
          if (p.y < 120) {
            color = "gold";
          }
        }

        // è¶³å ´
        ctx.fillStyle = color;
        ctx.fillRect(p.x, p.y, p.width, p.height);

        // æ”¯æŸ±
        let cx = p.x + p.width/2 - TOWER_COLUMN_WIDTH/2;
        let cy = p.y;
        ctx.fillRect(cx, cy, TOWER_COLUMN_WIDTH, TOWER_COLUMN_HEIGHT);
      }
    }

    // ------------------------------------------
    // éšœå®³ç‰©æç”»
    // ------------------------------------------
    function drawObstacles() {
      ctx.font = "28px serif";
      ctx.textBaseline = "top";
      for (let o of obstacles) {
        ctx.fillText(o.symbol, o.x, o.y);
      }
    }

    // ------------------------------------------
    // çŒ«æç”»
    // ------------------------------------------
    function drawCat() {
      const catEmoji = "ğŸˆ";
      ctx.save();
      ctx.font = "38px serif";
      ctx.textBaseline = "top";

      let drawX = cat.x;
      let drawY = cat.y - 6; // æµ®ãã‚’æŠ‘ãˆã‚‹

      if (!cat.facingRight) {
        ctx.translate(drawX, drawY);
        ctx.fillText(catEmoji, 0, 0);
      } else {
        ctx.translate(drawX + cat.width, drawY);
        ctx.scale(-1, 1);
        ctx.fillText(catEmoji, 0, 0);
      }
      ctx.restore();
    }

    // ------------------------------------------
    // HUD (è·é›¢, ãƒ©ã‚¤ãƒ•)
    // ------------------------------------------
    function drawHUD() {
      ctx.fillStyle = "#000";
      ctx.font = "16px sans-serif";
      ctx.fillText(`Height: ${Math.floor(distance)}`, 10, 10);

      // ãƒ©ã‚¤ãƒ•(ğŸŸ)
      for (let i = 0; i < lives; i++) {
        ctx.fillText("ğŸŸ", 10 + i*25, 30);
      }
    }

    // ------------------------------------------
    // ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—
    // ------------------------------------------
    function gameLoop() {
      if (isGameRunning) {
        update();
        ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
        draw();
        requestAnimationFrame(gameLoop);
      }
    }

    // åˆæœŸåŒ–
    initPlatforms();
    gameLoop();
  </script>
</body>
</html>
